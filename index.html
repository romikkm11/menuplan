<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫ –º–µ–Ω—é</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            background-color: #f4f4f4;
            display: flex;
            transition: margin-left 0.3s;
        }
        .sidebar {
            width: 200px;
            background-color: #333;
            color: white;
            height: 100vh;
            padding: 20px;
            position: fixed;
            transition: width 0.3s;
        }
        .sidebar.collapsed {
            width: 60px;
        }
        .sidebar h2 {
            margin: 0 0 20px;
            font-size: 1.2em;
            display: block;
        }
        .sidebar.collapsed h2 {
            display: none;
        }
        .sidebar a {
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 4px;
        }
        .sidebar a:hover {
            background-color: #555;
        }
        .sidebar a span {
            margin-left: 10px;
            display: inline;
        }
        .sidebar.collapsed a span {
            display: none;
        }
        .toggle-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.2em;
            cursor: pointer;
            padding: 10px;
            width: 100%;
            text-align: left;
        }
        .content {
            margin-left: 220px;
            padding: 20px;
            max-width: 900px;
            flex: 1;
            transition: margin-left 0.3s;
        }
        .content.collapsed {
            margin-left: 80px;
        }
        h1, h2 {
            color: #333;
        }
        .section {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        select, button {
            padding: 8px;
            margin: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        button {
            background-color: #28a745;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #218838;
        }
        .menu, .shopping-list {
            margin-top: 10px;
        }
        .menu-day, .shopping-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        .menu-day {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
        }
        .menu-day strong {
            flex: 0 0 100px;
        }
        .menu-day select {
            flex: 1;
            min-width: 150px;
            max-width: 200px;
        }
        .error {
            color: red;
            display: none;
        }
        .total-cost {
            font-weight: bold;
            padding: 10px;
            margin-top: 10px;
            background-color: #f8f9fa;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="sidebar" id="sidebar">
        <button class="toggle-btn" onclick="toggleSidebar()">‚ò∞</button>
        <h2>–ú–µ–Ω—é</h2>
        <a href="index.html"><span role="img" aria-label="–ü–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫">üìÖ</span><span>–ü–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫</span></a>
        <a href="dishes.html"><span role="img" aria-label="–°—Ç—Ä–∞–≤–∏">üçΩÔ∏è</span><span>–°—Ç—Ä–∞–≤–∏</span></a>
        <a href="ingredients.html"><span role="img" aria-label="–Ü–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏">ü•ï</span><span>–Ü–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏</span></a>
    </div>
    <div class="content" id="content">
        <h1>–ü–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫ –º–µ–Ω—é –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å</h1>

        <div class="section">
            <h2>–°—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –º–µ–Ω—é</h2>
            <div id="menu">
                <div class="menu-day" data-day="–ü–æ–Ω–µ–¥—ñ–ª–æ–∫">
                    <strong>–ü–æ–Ω–µ–¥—ñ–ª–æ–∫:</strong>
                    <select class="menu-dish breakfast">
                        <option value="">–°–Ω—ñ–¥–∞–Ω–æ–∫</option>
                    </select>
                    <select class="menu-dish lunch">
                        <option value="">–û–±—ñ–¥</option>
                    </select>
                    <select class="menu-dish dinner">
                        <option value="">–í–µ—á–µ—Ä—è</option>
                    </select>
                </div>
                <div class="menu-day" data-day="–í—ñ–≤—Ç–æ—Ä–æ–∫">
                    <strong>–í—ñ–≤—Ç–æ—Ä–æ–∫:</strong>
                    <select class="menu-dish breakfast">
                        <option value="">–°–Ω—ñ–¥–∞–Ω–æ–∫</option>
                    </select>
                    <select class="menu-dish lunch">
                        <option value="">–û–±—ñ–¥</option>
                    </select>
                    <select class="menu-dish dinner">
                        <option value="">–í–µ—á–µ—Ä—è</option>
                    </select>
                </div>
                <div class="menu-day" data-day="–°–µ—Ä–µ–¥–∞">
                    <strong>–°–µ—Ä–µ–¥–∞:</strong>
                    <select class="menu-dish breakfast">
                        <option value="">–°–Ω—ñ–¥–∞–Ω–æ–∫</option>
                    </select>
                    <select class="menu-dish lunch">
                        <option value="">–û–±—ñ–¥</option>
                    </select>
                    <select class="menu-dish dinner">
                        <option value="">–í–µ—á–µ—Ä—è</option>
                    </select>
                </div>
                <div class="menu-day" data-day="–ß–µ—Ç–≤–µ—Ä">
                    <strong>–ß–µ—Ç–≤–µ—Ä:</strong>
                    <select class="menu-dish breakfast">
                        <option value="">–°–Ω—ñ–¥–∞–Ω–æ–∫</option>
                    </select>
                    <select class="menu-dish lunch">
                        <option value="">–û–±—ñ–¥</option>
                    </select>
                    <select class="menu-dish dinner">
                        <option value="">–í–µ—á–µ—Ä—è</option>
                    </select>
                </div>
                <div class="menu-day" data-day="–ü'—è—Ç–Ω–∏—Ü—è">
                    <strong>–ü'—è—Ç–Ω–∏—Ü—è:</strong>
                    <select class="menu-dish breakfast">
                        <option value="">–°–Ω—ñ–¥–∞–Ω–æ–∫</option>
                    </select>
                    <select class="menu-dish lunch">
                        <option value="">–û–±—ñ–¥</option>
                    </select>
                    <select class="menu-dish dinner">
                        <option value="">–í–µ—á–µ—Ä—è</option>
                    </select>
                </div>
                <div class="menu-day" data-day="–°—É–±–æ—Ç–∞">
                    <strong>–°—É–±–æ—Ç–∞:</strong>
                    <select class="menu-dish breakfast">
                        <option value="">–°–Ω—ñ–¥–∞–Ω–æ–∫</option>
                    </select>
                    <select class="menu-dish lunch">
                        <option value="">–û–±—ñ–¥</option>
                    </select>
                    <select class="menu-dish dinner">
                        <option value="">–í–µ—á–µ—Ä—è</option>
                    </select>
                </div>
                <div class="menu-day" data-day="–ù–µ–¥—ñ–ª—è">
                    <strong>–ù–µ–¥—ñ–ª—è:</strong>
                    <select class="menu-dish breakfast">
                        <option value="">–°–Ω—ñ–¥–∞–Ω–æ–∫</option>
                    </select>
                    <select class="menu-dish lunch">
                        <option value="">–û–±—ñ–¥</option>
                    </select>
                    <select class="menu-dish dinner">
                        <option value="">–í–µ—á–µ—Ä—è</option>
                    </select>
                </div>
            </div>
            <button onclick="generateShoppingList()">–°—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫</button>
            <p id="menuError" class="error">–í–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω—ñ –Ω–∞–∑–≤–∏ —Å—Ç—Ä–∞–≤!</p>
        </div>

        <div class="section">
            <h2>–°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫</h2>
            <div id="shoppingList" class="shopping-list"></div>
            <div id="totalCost" class="total-cost"></div>
        </div>
    </div>

    <script>
        let dishes = JSON.parse(localStorage.getItem('dishes')) || [];

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const content = document.getElementById('content');
            sidebar.classList.toggle('collapsed');
            content.classList.toggle('collapsed');
        }

        function updateMenuOptions() {
            const selectElements = document.querySelectorAll('.menu-dish');
            selectElements.forEach(select => {
                const currentValue = select.value;
                select.innerHTML = `<option value="">${select.options[0].text}</option>`;
                dishes.forEach(dish => {
                    const option = document.createElement('option');
                    option.value = dish.name;
                    option.textContent = dish.name;
                    select.appendChild(option);
                });
                select.value = currentValue;
            });
        }

        function generateShoppingList() {
            const menuDishes = Array.from(document.getElementsByClassName('menu-dish')).map(select => select.value.trim());
            const shoppingList = {};
            let totalCost = 0;
            let valid = true;

            menuDishes.forEach((dishName, index) => {
                if (!dishName) return;
                const dish = dishes.find(d => d.name.toLowerCase() === dishName.toLowerCase());
                if (!dish) {
                    valid = false;
                    return;
                }
                dish.ingredients.forEach(ing => {
                    const key = `${ing.name}_–∫–≥`;
                    if (!shoppingList[key]) {
                        shoppingList[key] = { name: ing.name, quantity: 0, unit: '–∫–≥', price: ing.price, totalCost: 0 };
                    }
                    shoppingList[key].quantity += ing.quantity;
                    if (ing.price) {
                        shoppingList[key].totalCost = shoppingList[key].quantity * ing.price;
                        totalCost += shoppingList[key].totalCost;
                    }
                });
            });

            if (!valid) {
                document.getElementById('menuError').style.display = 'block';
                return;
            }

            document.getElementById('menuError').style.display = 'none';
            const shoppingListDiv = document.getElementById('shoppingList');
            shoppingListDiv.innerHTML = '';
            Object.values(shoppingList).forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'shopping-item';
                itemDiv.textContent = `${item.name}: ${item.quantity} –∫–≥${item.price ? `, –∑–∞–≥–∞–ª—å–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å: ${item.totalCost.toFixed(2)} –≥—Ä–Ω` : ''}`;
                shoppingListDiv.appendChild(itemDiv);
            });

            const totalCostDiv = document.getElementById('totalCost');
            totalCostDiv.textContent = totalCost > 0 ? `–ó–∞–≥–∞–ª—å–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å: ${totalCost.toFixed(2)} –≥—Ä–Ω` : '–ó–∞–≥–∞–ª—å–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å –Ω–µ —Ä–æ–∑—Ä–∞—Ö–æ–≤–∞–Ω–∞ (–≤—ñ–¥—Å—É—Ç–Ω—ñ —Ü—ñ–Ω–∏)';
        }

        window.onload = () => {
            updateMenuOptions();
        };
    </script>
</body>
</html>